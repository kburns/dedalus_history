{"links": {"self": {"href": "data/repositories/dedalus-project/dedalus/issues/29/comments/19363278.json"}, "html": {"href": "#!/dedalus-project/dedalus/issues/29#comment-19363278"}}, "issue": {"links": {"self": {"href": "data/repositories/dedalus-project/dedalus/issues/29.json"}}, "type": "issue", "id": 29, "repository": {"links": {"self": {"href": "data/repositories/dedalus-project/dedalus.json"}, "html": {"href": "#!/dedalus-project/dedalus"}, "avatar": {"href": "data/bytebucket.org/ravatar/{1dc39ab6-2798-450d-af2f-e976f94b5794}ts=2009435"}}, "type": "repository", "name": "dedalus", "full_name": "dedalus-project/dedalus", "uuid": "{1dc39ab6-2798-450d-af2f-e976f94b5794}"}, "title": "Proper evaluation of duplicated subtrees"}, "content": {"raw": "This bug comes up when there are redundant subtrees being evaluated simultaneously.  I'm working on a better long-term solution for this process, but currently you can set an attribute on an operator that will cache its output within each solver iteration, which should fix this problem.  \n\nAfter you've added all parameters/substitutions, you want to set the `store_last` attribute to True on any non-function substitutions that you use in multiple equations / analysis tasks.  Here that would be:\n\nproblem.namespace['enstrophy'].store_last = True\n\nWe could do this as the default for all operators, but that may result in memory issues.  I'll change this to on-hold for now, and maybe change the issue title to reflect the (very obscure) source of the bug, if that's ok with you.", "markup": "markdown", "html": "<p>This bug comes up when there are redundant subtrees being evaluated simultaneously.  I'm working on a better long-term solution for this process, but currently you can set an attribute on an operator that will cache its output within each solver iteration, which should fix this problem.  </p>\n<p>After you've added all parameters/substitutions, you want to set the <code>store_last</code> attribute to True on any non-function substitutions that you use in multiple equations / analysis tasks.  Here that would be:</p>\n<p>problem.namespace['enstrophy'].store_last = True</p>\n<p>We could do this as the default for all operators, but that may result in memory issues.  I'll change this to on-hold for now, and maybe change the issue title to reflect the (very obscure) source of the bug, if that's ok with you.</p>", "type": "rendered"}, "created_on": "2015-06-29T12:19:20.614835+00:00", "user": {"display_name": "Keaton Burns", "uuid": "{3d3e64f1-bf12-45df-b655-4543d8fb34c4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d3e64f1-bf12-45df-b655-4543d8fb34c4%7D"}, "html": {"href": "https://bitbucket.org/%7B3d3e64f1-bf12-45df-b655-4543d8fb34c4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:e31a7835-5317-4dfa-8551-f32a06f40279/40f33f99-2b75-4a17-a8c2-07c8d74c7480/128"}}, "nickname": "kburns", "type": "user", "account_id": "557058:e31a7835-5317-4dfa-8551-f32a06f40279"}, "updated_on": null, "type": "issue_comment", "id": 19363278}